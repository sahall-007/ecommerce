<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Shopping Cart</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700&display=swap"
        rel="stylesheet">
    <style>
        html,
        body {
            height: 100%;
            font-family: "Titillium Web", sans-serif;
        }

        body {
            display: flex;
            min-height: 100vh;
            flex-direction: column;
        }

        .main-content {
            flex: 1 0 auto;
        }

        footer {
            flex-shrink: 0;
        }

        .cart-item {
            border-bottom: 1px solid #eee;
            padding: 1.5rem 0;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .quantity-btn {
           
            cursor: pointer;
        }

        .btn-proceed {
            background-color: #ff6d00;
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 600;
        }

        .btn-proceed:hover {
            background-color: #e65c00;
        }

        @media (max-width: 576px) {

            .table th,
            .table td {
                font-size: 0.9rem;
            }    
        }

        .navbar {
            padding: 0.8rem 1rem;
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }

        .navbar .form-control {
            width: 220px;
            border-radius: 0.375rem 0 0 0.375rem;
        }

        .navbar .btn-outline-secondary {
            border-radius: 0 0.375rem 0.375rem 0;
        }

        .nav-link:hover {
            color: #0d6efd !important;
        }

        @media (max-width: 992px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                box-shadow: none;
            }

            .content {
                margin-left: 0;
            }
        }

        .sidebar {
            /* width: 250px; */
            /* flex-shrink: 0; */
            background: #fff;
            /* height: 100vh; */
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            /* position: fixed;
            left: 0;
            top: 0;
            padding-top: 20px; */
        }

        .sidebar a {
            display: block;
            padding: 12px 20px;
            font-size: 15px;
            color: #333;
            text-decoration: none;
        }

        .sidebar a:hover {
            background: #f0f3f7;
        }

        .timeline-steps {
            position: relative;
        }

        .timeline-step {
            text-align: center;
            flex: 1;
            position: relative;
        }

        .timeline-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
        }

        .timeline-connector {
            flex: 1;
            height: 2px;
            background: #e0e0e0;
            margin: 20px 0;
            position: relative;
            top: -20px;
        }

        .timeline-step.completed .timeline-connector {
            background: #28a745;
        }

        @media (max-width: 576px) {
            .timeline-connector {
                display: none;
            }

            .timeline-step {
                margin-bottom: 20px;
            }
        }
    </style>
</head>

<body class="bg-light">

    <!-- ==================== NAVBAR ==================== -->
    <nav class="navbar navbar-expand-lg bg-black shadow-sm">
        <div class="container">
            <a class="navbar-brand text-light fw-bold d-flex align-items-center" href="#">
                <i class="bi bi-box me-2"></i> ShopEase
            </a>
            <button class="navbar-toggler bg-light" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav mx-auto text-center mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link text-light active" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link text-light" href="#">Contact</a></li>
                    <li class="nav-item"><a class="nav-link text-light" href="#">About Us</a></li>
                    <li class="nav-item"><a class="nav-link text-light" href="/allProducts">Shop List</a></li>
                </ul>

                <div class="d-lg-flex flex-column flex-lg-row align-items-center gap-5">
                    <div class="d-flex align-items-center justify-content-center gap-5 mt-lg-0 mt-3 mb-3 mb-lg-1">
                        <a href="/wishlist" class="text-light"><i class="bi bi-heart"></i></a>
                        <a href="/cart" class="text-light"><i class="bi bi-cart3"></i></a>
                        <a href="/profile" class="text-light"><i class="bi bi-person-circle"></i></a>
                    </div>
                    <div class="d-flex justify-content-center">
                        <a href="/logout" class="btn btn-outline-light">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ==================== USER QUICK LINKS (horizontal on large screens) ==================== -->
    <%- include("../partials/user/userQuickLinks.ejs") %>

    <!-- ==================== MAIN CONTENT ==================== -->
        <% if(order){ %>

            <div class="main-content">
                <div class="container py-5">
                    <div class="row">
                        <!-- Cart Items -->
                        <div class="col-lg-8">
                            <!-- Page Title -->
                            <div class="d-flex align-items-center justify-content-between mb-4">
                                <h2 class="h4 mb-0 text-dark">Order Details</h2>
                                <a href="/orders" class="btn btn-outline-secondary btn-sm">
                                    <i class="bi bi-arrow-left me-2"></i>Back to Orders
                                </a>
                            </div>

                            <!-- Order Summary Card -->
                            <div class="card border-0 shadow-sm mb-4">

                                <!-- =========== CARD HEADER ========== -->
                                <div class="card-header bg-dark bg-gradient text-white">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <h5 class="mb-0"><%= order.orderId %></h5>
                                            <small>Placed on <%= new Date(order.placedAt).toLocaleDateString('en-GB', {
                                                weekday: 'short',
                                                day: 'numeric',
                                                month: 'short',
                                                year: 'numeric'
                                            }) %></small>
                                        </div>
                                       
                                    </div>
                                </div>

                                <div class="card-body">
                                    <div class="row g-4">
                                        <!-- Order Items -->
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">Items Ordered</h6>
                                            
                                            <!-- ============== ITEM 1==================== -->
                                            <% if(order?.items.length > 0){ %>
                                                <% order?.items.forEach(ele => { %>

                                                    <% 
                                                        let status = ele.status || order.status;
                                                        let btnColor = 
                                                            status === "Pending" ? "warning" :
                                                            status === "Delivered" || status === "partially delivered" ? "success" :
                                                            status === "Shipped" || status === "partially shipped" ? "primary" :
                                                            status === "Cancelled" || status === "Returned" || status === "Refunded" ? "danger" :
                                                            "secondary";

                                                        let cardHeaderBg = 
                                                            (status == "Return requested") ? "bg-danger" : 
                                                            (status == "Return approved") ?" bg-success" : 
                                                            (status == "Returning") ?" bg-warning bg-opacity-75" : ""


                                                        let cardHeaderText = 
                                                            (status == "Return requested") ? "Return request" : 
                                                            (status == "Return approved") ?" Return Approved" : 
                                                            (status == "Returning") ? "Returning" : ""

                                                        let cardBg = 
                                                            (status == "Return requested") ? "bg-danger bg-opacity-10" : 
                                                            (status == "Return approved") ? "bg-success bg-opacity-10" : 
                                                            (status == "Returning") ? "bg-warning bg-opacity-10" : "bg-light"
                                                    %>

                                                    <div class="card mb-3">
                                                        <% if(["Return requested", "Return approved", "Returning"].includes(status)){ %>
                                                            <div class="card-header <%= cardHeaderBg %>">
                                                                <div class="text-light "><%= cardHeaderText %></div>
                                                            </div>
                                                        <%}%>
                                                        <div class="card-body rounded-3 p-3  <%= cardBg %>">
                                                            
                                                            <div class="row align-items-center g-3">
                                                                <!-- =============== TIME LINE================= -->
                                                                <% if(!["Cancelled", "Returned", "Refunded", "Returning", "Return requested", "Return approved"].includes(status)){ %>
                                                                    <div class="col-md-12">
                                                                        <div class="timeline-steps">
                                                                            <div class="d-flex flex-wrap align-items-center mb-4">
                                                                                <div class="timeline-step completed">
                                                                                    <div class="timeline-icon bg-success text-white">
                                                                                        <i class="bi bi-check-lg"></i>
                                                                                    </div>
                                                                                    <div class="timeline-label">Order Placed
                                                                                    </div>
                                                                                </div>
                                                                                <div class="timeline-connector"></div>
                                                                                <div class="timeline-step completed">
                                                                                    <div class="timeline-icon bg-success text-white">
                                                                                        <% if(status=="Out for delivery" || status=="Shipped" || status=="Delivered" || status=="Return rejected"){ %>
                                                                                            <i class="bi bi-check-lg"></i>
                                                                                        <% } else { %>
                                                                                            <i class="bi bi-box2"></i>
                                                                                        <% } %>                                                                                    
                                                                                    </div>
                                                                                    <div class="timeline-label">Out for delivery</div>
                                                                                </div>
                                                                                <div class="timeline-connector"></div>
                                                                                <div class="timeline-step completed">
                                                                                    <div class="timeline-icon bg-success text-white">
                                                                                        <% if(status=="Shipped" || status=="Delivered" || status=="Return rejected"){ %>
                                                                                            <i class="bi bi-check-lg"></i>
                                                                                        <% } else { %>
                                                                                            <i class="bi bi-truck"></i>
                                                                                        <% } %> 
                                                                                        
                                                                                    </div>
                                                                                    <div class="timeline-label">Shipped</div>
                                                                                </div>
                                                                                <div class="timeline-connector"></div>
                                                                                <div class="timeline-step completed">
                                                                                    <div class="timeline-icon bg-success text-white">
                                                                                        <% if(status=="Delivered" || status=="Return rejected"){ %>
                                                                                            <i class="bi bi-check-lg"></i>
                                                                                        <% } else { %>
                                                                                            <i class="bi bi-house-door"></i>
                                                                                        <% } %> 
                                                                                        
                                                                                    </div>
                                                                                    <div class="timeline-label">Delivered</div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>                                                            
                                                                <% } %>
    
                                                                <div class="col-auto">
                                                                    <img src="/<%= ele.image %>"
                                                                        class="rounded" width="80" height="80" alt="Product">
                                                                </div>
                                                                <div class="col">
                                                                    <h6 class="mb-1"><%= ele.name %></h6>
                                                                    <small class="text-muted"><%= ele.ram %> | <%= ele.storage %> | <%= ele.color %></small>
    
                                                                    <% 
                                                                        let price = Number(ele.price); 
                                                                        let discount = Number(ele.discount); 
                                                                        let offAmount = price * (discount / 100); 
                                                                        let finalPrice = Math.floor(price - offAmount);
                                                                    %>
    
                                                                    <div class="fw-light text-success" style="font-size: small">&#8377; <%= finalPrice %>
                                                                        <span class="text-decoration-line-through text-danger" style="font-size: smaller">&#8377; <%= ele.price %></span>
                                                                        <span class="text-success"><%= ele.discount %>% off</span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-auto">
                                                                    
                                                                    <% if(["Return requested", "Return approved", "Returning", "Return rejected"].includes(status)){ %>
                                                                        <% if(status=="Return rejected"){ %>
                                                                            <div>
                                                                                <div class="text-end">
                                                                                    
                                                                                    <button class="btn btn-dark btn-sm mb-1"  data-bs-toggle="modal" data-bs-target="#returnRejectModal">Show Reason</button>
                                                                                </div>
                                                                                <div  class="text-end">
    
                                                                                    <button class="btn btn-danger btn-sm"><%= status %></button>
                                                                                </div>
                                                                            </div>
                                                                        <% } else{ %>
                                                                            <div>
                                                                                <div class="text-end">
                                                                                    
                                                                                    <button class="btn btn-dark btn-sm mb-1"  data-bs-toggle="modal" data-bs-target="#showReturnReasonModal">Show Reason</button>
                                                                                </div>
                                                                                <div  class="text-end">
    
                                                                                    <button class="btn btn-danger btn-sm"><%= status %></button>
                                                                                </div>
                                                                            </div>
                                                                        <% } %>
                                                                    
                                                                    <%  }else{ %>
    
    
                                                                        <div class="mb-2 text-end">
                                                                            <button class="badge bg-<%= btnColor %> text-center px-3 py-2 border-0 ">
                                                                                <%= status %>
                                                                            </button>
                                                                        </div>
    
                                                                        <% if(!["Delivered", "Cancelled", "Returned", "Return requested", "Returned rejected", "Returning"].includes(status)){ %>
                                                                            <button class="btn btn-danger btn-sm" onclick='cancelOrder("<%= ele._id %>", "<%= order.userId._id %>", event)'>Cancel Order</button>
                                                                        <% } %>
                                                                        <% if(status=="Delivered"){ %>
                                                                            <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#returnReasonModal">Return Order</button>
                                                                        <% } %>
    
                                                                    <% } %>
    
                                                                    <!-- =================RETURN REASON MODAL================= -->
                                                                    <div class="modal fade" id="returnReasonModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" >
                                                                            <div class="modal-content bg-dark text-light">
                                                                                <div class="modal-header border-secondary">
                                                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Return reason ?</h1>
                                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <form id="returnForm">
                                                                                    <div class="modal-body">
    
                                                                                        <input type="hidden" name="itemId" value="<%= ele._id %>" id="itemId">
                                                                                        <input type="hidden" name="userId" id="userId" value="<%= order.userId._id %>">
    
                                                                                        <div class="mb-4 mt-3">
                                                                                            <label class="" for="returnReason">Select your reason</label>
                                                                                            <select class="form-select bg-dark text-light border-secondary" name="returnReason" id="returnReason">
                                                                                                <option value="" selected>Select a reason</option>
                                                                                                <option value="Product is broken">Product is broken</option>
                                                                                                <option value="Wrong quantity delivered">Wrong quantity delivered</option>
                                                                                                <option value="Product has scratches or dents">Product has scratches or dents</option>
                                                                                                <option value="Performance issue">Performance issue</option>
                                                                                                <option value="Battery or electronics problem">Battery or electronics problem</option>
                                                                                                <option value="Color doesn’t match the picture">Color doesn’t match the picture</option>
                                                                                            </select>
                                                                                        </div>
                
                                                                                        <div class="my-4">
                                                                                            <label for="custonReturnReason">Be more specific (optional)</label>
                                                                                            <textarea class="form-control bg-dark  text-light border-secondary" name="custonReturnReason" id="custonReturnReason"></textarea>
                                                                                        </div>
                
                                                                                        <label for="imageInput">Upload image (optional)</label>
                                                                                        <div class="input-group mb-3">
                                                                                            <input type="file" class="form-control bg-dark text-light border-secondary" name="returnImage" id="imageInput">            
                                                                                        </div>
                
                                                                                    </div>
                                                                                    <div class="modal-footer border-secondary">
                                                                                        <button type="reset" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                                                        <button type="submit" class="btn btn-primary"  onclick='returnOrder(event)'  data-bs-dismiss="modal">Request return</button>
                                                                                    </div>
                                                                                </form>
                                                                            </div>
                                                                        </div>
                                                                    </div>
    
                                                                    <!-- ===================SHOW RETURN REASON MODAL================= -->                                                                        
                                                                    <div class="modal fade" id="showReturnReasonModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" >
                                                                            <div class="modal-content bg-dark text-light">
                                                                                <div class="modal-header border-secondary">
                                                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Return reason</h1>
                                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <form id="returnForm">
                                                                                    <div class="modal-body text-start">
    
                                                                                        <div class="mb-4 mt-3">
                                                                                            <label class="" for="returnReason">Return reason</label>
                                                                                            <input class="form-control bg-dark text-light border-secondary" type="text" value="<%= ele?.return?.reason %>" disabled>
                                                                                        </div>
                
                                                                                        <div class="my-4">
                                                                                            <label for="custonReturnReason">More specific reason</label>
                                                                                            <textarea class="form-control bg-dark  text-light border-secondary"  disabled><%= ele?.return?.customReason || "Null" %></textarea>
                                                                                        </div>
                
                                                                                        <% if(ele?.return?.image){ %>
                                                                                            <label for="imageInput">Uploaded image</label>
                                                                                            <img src="/<%= ele?.return?.image %>" alt="" style="width: 100px; height: 100px;">                                                                                           
                                                                                        <% } %>
                
                                                                                    </div>
                                                                                    <div class="modal-footer border-secondary">
                                                                                        <button type="reset" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                                                    </div>
                                                                                </form>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <!-- =================RETURN REJECT REASON MODAL================= -->
                                                                    <div class="modal fade" id="returnRejectModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" >
                                                                            <div class="modal-content bg-dark text-light">
                                                                                <div class="modal-header border-secondary">
                                                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Reject reason</h1>
                                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <form id="rejectRequestForm">
                                                                                    <div class="modal-body text-start">

                                                                                        <div class="mb-4 mt-3">
                                                                                            <label class="" for="returnReason">Reject reason</label>
                                                                                            <input class="form-control bg-dark text-light border-secondary" type="text" value="<%= ele?.returnReject?.reason %>" disabled>
                                                                                        </div>
                
                                                                                        <div class="my-4">
                                                                                            <label for="custonReturnReason">Be more specific (optional)</label>
                                                                                            <textarea class="form-control bg-dark  text-light border-secondary"  disabled><%= ele?.returnReject?.customReason || "Null" %></textarea>
                                                                                        </div>
                
                                                                                    </div>
                                                                                    <div class="modal-footer border-secondary">
                                                                                        <button type="reset" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                                                    </div>
                                                                                </form>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
    
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                <% }) %>                                        
                                            <% } %>

                                            

                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- Summary -->
                        <div class="col-lg-4 mt-4 mt-lg-0">

                            <!-- address -->
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Shipping Address</h6>
                                </div>
                                <div class="card-body">
                                    <p class="mb-1 fw-semibold"><%= order.billingAddress.fullname %></p>
                                    <p class="text-muted mb-1"><%= order.billingAddress.phone %></p>
                                    <p class="text-muted mb-1"><%= order.billingAddress.address %></p>
                                    <p class="text-muted mb-0"><%= order.billingAddress.pincode %></p>
                                </div>
                            </div>

                            <!-- order summay -->
                            <%
                                let couponCode = 
                                    (order?.couponCode) ? order.couponCode : "Null"
                            %> 
                            <div class="bg-white rounded-3 shadow-sm p-4  mt-2"" style=" top: 1rem; z-index: 10;">
                                <h5 class="mb-3" id="itemCount">Coupon code</h5>
                        
                                <input type="text" class="form-control" name="coupon" id="coupon"
                                    value="<%= couponCode %>" disabled>
                                    
                                <hr>

                                <h5 class="mb-3" id="itemCount">Payment Methods</h5>
                                <ul style="list-style-type: none;">
                                    <li>
                                        <input type="radio" class="paymentMethod" name="paymentMethod" id="paymentMethod" checked>
                                        <label for="paymentMethod" class="fs-6"><%= order.paymentMethod %></label>
                                    </li>                                    
                                </ul>
                                <hr>
                                <h5 class="mb-3" id="itemCount">Price (<%= order?.items?.length %> items)</h5>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Sub total:</span>
                                    <span id="totalPrice" class="total-price">&#8377; <%= order?.totalPriceBeforeDiscount %>.00</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <% let couponDiscount=0 %>
                                        <span>Coupon discount:</span>
                                        <span id="couponDiscount" class="total-price">&#8377; <%= order?.discountAmount %>.00</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Shipping charge:</span>
                                    <span id="shippingCharge" class="total-price">&#8377; 50.00</span>
                                </div>
                                <div class="d-flex justify-content-between mt-3">
                                    <span class="fw-bold">Total Amount:</span>
                                    <span id="finalPrice" class="total-price text-success fw-bold">&#8377; <%= order?.payablePrice %>.00</span>
                                </div>

                                
                            </div>

                        </div>
                    </div>
                </div>
            </div>        
        <% } %>

                    <!-- ==================== FOOTER (always at the bottom) ==================== -->
<footer class="bg-dark text-white text-center py-3 mt-auto">
    <p class="mb-0">© 2025 ShopEase. All rights reserved.</p>
</footer>






<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    window.addEventListener("unload", function () { });

    async function cancelOrder(itemId, userId, event) {
        // alert(itemId)
        event.preventDefault()

        swal.fire({
            icon: "question",
            title: "Are you sure",
            showCancelButton: true,
            confirmButtonText: "confirm",
        })
        .then(async (result) => {
            if(result.isConfirmed){
                try{    
                    const request = await fetch('/cancel', {
                        method: "POST",
                        headers: {"Content-Type": "application/json" },
                        body: JSON.stringify({itemId, userId})
                    })
                    if(request.status==200){
                        swal.fire({
                            icon: "success",
                            title: "Success",
                            text: "This product is cancelled"
                        })
                        .then(() => window.location.reload())
                    }
                    else if(request.status==404){
                        swal.fire({
                            icon: "error",
                            title: "Error",
                            text: "Order not found"
                        })
                    }
                    else if(request.status==400){
                        swal.fire({
                            icon: "error",
                            title: "Error",
                            text: "This item is not cancellable"
                        })
                    }
                    else if(request.status==500){
                        swal.fire({
                            icon: "error",
                            title: "Error",
                            text: "Soething went wrong"
                        })
                    }

                }
                catch(err){
                    alert("cancel product error")
                    console.log(err)
                }
            }
        })        
    }
    
    async function returnOrder(event){
        event.preventDefault()

        // swal.fire({
        //     icon: "question",
        //     title: "Are you sure",
        //     showCancelButton: true,
        //     confirmButtonText: "confirm",
        // })
        // .then(async (result) => {
        //     if (result.isConfirmed) {
        //     }
        // })

        const itemId = document.getElementById("itemId").value
        const userId = document.getElementById("userId").value

        console.log("this is itemId", itemId)
        console.log("this is userId", userId)

        
        // const reason = document.getElementById("returnReason").value
        // const customReason = document.getElementById("custonReturnReason").value
        const image = document.getElementById("imageInput").files[0]

        
        const form = document.getElementById("returnForm")
        const formdata = new FormData(form)


        formdata.append(`returnImage`, `${image}.jpeg`);

        try{
            const request = await fetch('/return', {
                method: "POST",               
                body: formdata
            })
            if(request.status==200){
                swal.fire({
                    icon: "success",
                    title: "Success",
                    text: "This product is cancelled"
                })
                .then(() => window.location.reload())
            }
            else if(request.status==404){
                swal.fire({
                    icon: "error",
                    title: "Error",
                    text: "Order not found"
                })
            }
            else if(request.status==400){
                swal.fire({
                    icon: "error",
                    title: "Error",
                    text: "This item is not cancellable"
                })
            }
            else if(request.status==500){
                swal.fire({
                    icon: "error",
                    title: "Error",
                    text: "variant not found or Server error"
                })
            }
        }
        catch(err){
            alert("return product error")
            console.log(err)
        }
    }

    
    
</script>
</body>

</html>